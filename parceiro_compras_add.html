<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solicitar Cota√ß√£o - RFQ WhatsApp</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 500px; 
      margin: 2rem auto; 
      padding: 1rem;
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      min-height: 100vh;
    }
    
    .container {
      background: white;
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    h1 {
      color: #128C7E;
      text-align: center;
      margin-bottom: 1.5rem;
      font-size: 1.8rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #333;
    }
    
    textarea {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      min-height: 80px;
      transition: border-color 0.3s ease;
    }
    
    textarea:focus {
      outline: none;
      border-color: #25D366;
      box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
    }
    
    fieldset { 
      border: 2px solid #e1e5e9; 
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1.5rem;
    }
    
    legend {
      font-weight: 600;
      color: #128C7E;
      padding: 0 0.5rem;
    }
    
    .fornecedor-item {
      display: flex;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #f0f0f0;
    }
    
    .fornecedor-item:last-child {
      border-bottom: none;
    }
    
    .fornecedor-item input[type="checkbox"] {
      margin-right: 0.75rem;
      transform: scale(1.2);
      accent-color: #25D366;
    }
    
    .fornecedor-item label {
      margin-bottom: 0;
      font-weight: normal;
      cursor: pointer;
      flex: 1;
    }
    
    button { 
      width: 100%;
      padding: 1rem;
      background: #25D366;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    button:hover {
      background: #128C7E;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
    }
    
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .loading {
      display: none;
      text-align: center;
      margin-top: 1rem;
      color: #25D366;
      font-weight: 600;
    }
    
    .resultado {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      display: none;
    }
    
    .resultado.sucesso {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }
    
    .resultado.erro {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }
    
    .ajuda {
      font-size: 0.85rem;
      color: #666;
      margin-top: 0.25rem;
    }
    
    .whatsapp-icon {
      display: inline-block;
      margin-right: 0.5rem;
    }
    
    @media (max-width: 600px) {
      body {
        margin: 1rem;
        padding: 0.5rem;
      }
      
      .container {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>
      <span class="whatsapp-icon">üì±</span>
      Solicitar Cota√ß√£o
    </h1>
    
    <form id="formRfq">
      <div class="form-group">
        <label for="produto">
          üì¶ Produto(s) para Cota√ß√£o:
        </label>
        <textarea 
          id="produto" 
          name="produto" 
          placeholder="Digite o produto ou lista de produtos (um por linha)..." 
          required
        ></textarea>
        <div class="ajuda">
          üí° Para m√∫ltiplos produtos, digite um por linha
        </div>
      </div>

      <fieldset>
        <legend>üë• Fornecedores</legend>
        
        <div class="fornecedor-item">
          <input type="checkbox" id="fornecedor1" name="fornecedores" value="5511998821973" />
          <label for="fornecedor1">üß™ Teste - Seu N√∫mero (5511998821973)</label>
        </div>
        
        <div class="fornecedor-item">
          <input type="checkbox" id="fornecedor2" name="fornecedores" value="5592985960527" />
          <label for="fornecedor2">üè¢ Queiroz Distribuidora</label>
        </div>
        
        <div class="fornecedor-item">
          <input type="checkbox" id="fornecedor3" name="fornecedores" value="5511998821973" />
          <label for="fornecedor3">üè™ Atacad√£o</label>
        </div>
        
        <div class="fornecedor-item">
          <input type="checkbox" id="fornecedor4" name="fornecedores" value="5592981437527" />
          <label for="fornecedor4">üì¶ Distribuidora Analin</label>
        </div>
        
        <div class="fornecedor-item">
          <input type="checkbox" id="fornecedor5" name="fornecedores" value="5511998821973" />
          <label for="fornecedor5">üöö Centralimp</label>
        </div>
      </fieldset>

      <button type="submit" id="btnEnviar">
        <span class="whatsapp-icon">üí¨</span>
        Enviar RFQ por WhatsApp
      </button>
    </form>

    <div class="loading" id="loading">
      ‚è≥ Enviando mensagens... Aguarde.
    </div>

    <div class="resultado" id="resultado"></div>
  </div>

  <script>
    const form = document.getElementById('formRfq');
    const loading = document.getElementById('loading');
    const resultado = document.getElementById('resultado');
    const btnEnviar = document.getElementById('btnEnviar');

    // URL do webhook n8n - ALTERE se necess√°rio
    const WEBHOOK_URL = 'https://7889-177-149-110-251.ngrok-free.app/webhook/rfq-webhook';

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Coletar dados do formul√°rio
      const formData = new FormData(form);
      const produto = formData.get('produto').trim();
      const fornecedores = formData.getAll('fornecedores');
      
      // Valida√ß√µes
      if (!produto) {
        mostrarResultado('Por favor, digite pelo menos um produto.', 'erro');
        return;
      }
      
      if (!fornecedores.length) {
        mostrarResultado('Selecione pelo menos um fornecedor.', 'erro');
        return;
      }
      
      // Preparar dados para envio
      const dadosEnvio = {
        produto: produto,
        fornecedores: fornecedores
      };
      
      // Debug - mostrar dados sendo enviados
      console.log('Enviando dados:', dadosEnvio);
      
      try {
        // Mostrar loading
        setLoading(true);
        
        // Enviar para o webhook
        const response = await fetch(WEBHOOK_URL, {
          method: 'POST',
          mode: 'cors',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify(dadosEnvio)
        });
        
        console.log('Response status:', response.status);
        
        // Sempre mostrar sucesso para webhook.site (que n√£o retorna JSON v√°lido)
        mostrarResultado(`‚úÖ Dados enviados com sucesso! Verifique o webhook.site`, 'sucesso');
        form.reset();
        
      } catch (error) {
        console.error('Erro na requisi√ß√£o:', error);
        mostrarResultado(`‚ùå Erro de conex√£o: ${error.message}`, 'erro');
      } finally {
        setLoading(false);
      }
    });

    function setLoading(isLoading) {
      if (isLoading) {
        loading.style.display = 'block';
        btnEnviar.disabled = true;
        btnEnviar.innerHTML = '<span class="whatsapp-icon">‚è≥</span> Enviando...';
        resultado.style.display = 'none';
      } else {
        loading.style.display = 'none';
        btnEnviar.disabled = false;
        btnEnviar.innerHTML = '<span class="whatsapp-icon">üí¨</span> Enviar RFQ por WhatsApp';
      }
    }

    function mostrarResultado(mensagem, tipo) {
      resultado.textContent = mensagem;
      resultado.className = `resultado ${tipo}`;
      resultado.style.display = 'block';
      
      // Auto-hide ap√≥s 8 segundos se for sucesso
      if (tipo === 'sucesso') {
        setTimeout(() => {
          resultado.style.display = 'none';
        }, 8000);
      }
    }

    // Adicionar bot√£o "Selecionar Todos"
    const legend = document.querySelector('legend');
    const btnSelecionarTodos = document.createElement('button');
    btnSelecionarTodos.type = 'button';
    btnSelecionarTodos.textContent = '‚úÖ Todos';
    btnSelecionarTodos.style.cssText = `
      float: right;
      background: none;
      border: 1px solid #25D366;
      color: #25D366;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      cursor: pointer;
      width: auto;
      margin: 0;
    `;
    
    btnSelecionarTodos.addEventListener('click', () => {
      const checkboxes = document.querySelectorAll('input[name="fornecedores"]');
      const todosMarcados = Array.from(checkboxes).every(cb => cb.checked);
      
      checkboxes.forEach(cb => cb.checked = !todosMarcados);
      btnSelecionarTodos.textContent = todosMarcados ? '‚úÖ Todos' : '‚ùå Limpar';
    });
    
    legend.appendChild(btnSelecionarTodos);
  </script>
</body>
</html>
